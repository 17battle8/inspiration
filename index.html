<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>网址导航 - 我的收藏夹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .search-box {
            background: white;
            border-radius: 50px;
            padding: 15px 25px;
            margin: 0 auto 30px;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
        }

        .search-box input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 16px;
            padding: 5px;
        }

        .search-box i {
            color: #667eea;
            margin-left: 10px;
            font-size: 18px;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn {
            background: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: white;
            color: #667eea;
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .category {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .category:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .category-title-section {
            display: flex;
            align-items: center;
        }

        .category-icon {
            width: 50px;
            height: 50px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 24px;
            color: white;
        }

        .category-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #333;
        }

        .category-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
        }

        .links {
            display: grid;
            gap: 12px;
        }

        .link-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 12px;
            text-decoration: none;
            color: #333;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .link-item:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
            border-color: #667eea;
        }

        .link-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            opacity: 0.7;
        }

        .link-text {
            flex: 1;
            font-size: 14px;
        }

        .link-desc {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 2px;
        }

        .link-actions {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .link-item:hover .link-actions {
            opacity: 1;
        }

        .btn-mini {
            padding: 4px 8px;
            font-size: 10px;
            border-radius: 10px;
            background: rgba(255,255,255,0.9);
            color: #333;
        }

        .footer {
            text-align: center;
            margin-top: 50px;
            color: white;
            opacity: 0.8;
        }

        /* 模态框样式 */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
        }

        .close {
            font-size: 28px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            background: white;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }

        .btn-cancel {
            background: #f8f9fa;
            color: #6c757d;
        }

        .btn-submit {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .empty-category {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }

        .empty-category p {
            margin-bottom: 15px;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .categories {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .category {
                padding: 20px;
            }

            .action-buttons {
                flex-direction: column;
                align-items: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 10% auto;
                width: 95%;
                padding: 20px;
            }
        }

        /* 图标颜色 */
        .icon-3d { background: linear-gradient(135deg, #ff6b6b, #ee5a24); }
        .icon-hardware { background: linear-gradient(135deg, #4ecdc4, #44a08d); }
        .icon-software { background: linear-gradient(135deg, #45b7d1, #96c93d); }
        .icon-model { background: linear-gradient(135deg, #f9ca24, #f0932b); }
        .icon-ai { background: linear-gradient(135deg, #6c5ce7, #a29bfe); }
        .icon-image { background: linear-gradient(135deg, #fd79a8, #e84393); }
        .icon-design { background: linear-gradient(135deg, #00b894, #00cec9); }
        .icon-pm { background: linear-gradient(135deg, #e17055, #d63031); }
        .icon-prototype { background: linear-gradient(135deg, #74b9ff, #0984e3); }
        .icon-app { background: linear-gradient(135deg, #a8e6cf, #dcedc1); }
        .icon-custom { background: linear-gradient(135deg, #a29bfe, #6c5ce7); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔗 网址导航</h1>
            <p>我的收藏夹 - 精选优质网站资源</p>
        </div>

        <div class="search-box">
            <input type="text" id="searchInput" placeholder="搜索网站..." />
            <i>🔍</i>
        </div>

        <div class="action-buttons">
            <button class="btn btn-primary" onclick="openAddLinkModal()">
                <span>➕</span>
                添加网址
            </button>
            <button class="btn btn-secondary" onclick="openAddCategoryModal()">
                <span>📁</span>
                添加分类
            </button>
            <button class="btn btn-secondary" onclick="exportData()">
                <span>📤</span>
                导出数据
            </button>
            <button class="btn btn-secondary" onclick="importData()">
                <span>📥</span>
                导入数据
            </button>
        </div>

        <div class="categories" id="categoriesContainer">
            <!-- 分类将通过JavaScript动态生成 -->
        </div>

        <div class="footer">
            <p>© 2024 网址导航 - 让上网更高效</p>
        </div>
    </div>

    <!-- 添加网址模态框 -->
    <div id="addLinkModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">添加新网址</h2>
                <span class="close" onclick="closeModal('addLinkModal')">&times;</span>
            </div>
            <form id="addLinkForm">
                <div class="form-group">
                    <label class="form-label">网站名称 *</label>
                    <input type="text" class="form-input" id="linkName" required placeholder="例如：Google">
                </div>
                <div class="form-group">
                    <label class="form-label">网站地址 *</label>
                    <input type="url" class="form-input" id="linkUrl" required placeholder="https://www.google.com">
                </div>
                <div class="form-group">
                    <label class="form-label">网站描述</label>
                    <textarea class="form-textarea" id="linkDesc" rows="3" placeholder="网站的主要功能或特点"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">分类 *</label>
                        <select class="form-select" id="linkCategory" required>
                            <option value="">请选择分类</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">图标</label>
                        <input type="text" class="form-input" id="linkIcon" placeholder="例如：🌐">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">标签</label>
                        <input type="text" class="form-input" id="linkTags" placeholder="用逗号分隔，例如：搜索,工具,免费">
                    </div>
                    <div class="form-group">
                        <label class="form-label">优先级</label>
                        <select class="form-select" id="linkPriority">
                            <option value="1">低</option>
                            <option value="2" selected>中</option>
                            <option value="3">高</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('addLinkModal')">取消</button>
                    <button type="submit" class="btn btn-submit">添加网址</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 添加分类模态框 -->
    <div id="addCategoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">添加新分类</h2>
                <span class="close" onclick="closeModal('addCategoryModal')">&times;</span>
            </div>
            <form id="addCategoryForm">
                <div class="form-group">
                    <label class="form-label">分类名称 *</label>
                    <input type="text" class="form-input" id="categoryName" required placeholder="例如：学习资源">
                </div>
                <div class="form-group">
                    <label class="form-label">分类图标</label>
                    <input type="text" class="form-input" id="categoryIcon" placeholder="例如：📚">
                </div>
                <div class="form-group">
                    <label class="form-label">分类描述</label>
                    <textarea class="form-textarea" id="categoryDesc" rows="3" placeholder="分类的用途说明"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">分类颜色</label>
                    <select class="form-select" id="categoryColor">
                        <option value="icon-custom">自定义</option>
                        <option value="icon-3d">红色系</option>
                        <option value="icon-hardware">绿色系</option>
                        <option value="icon-software">蓝色系</option>
                        <option value="icon-model">黄色系</option>
                        <option value="icon-ai">紫色系</option>
                        <option value="icon-image">粉色系</option>
                        <option value="icon-design">青色系</option>
                        <option value="icon-pm">橙色系</option>
                        <option value="icon-prototype">蓝色系</option>
                        <option value="icon-app">绿色系</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('addCategoryModal')">取消</button>
                    <button type="submit" class="btn btn-submit">添加分类</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 编辑网址模态框 -->
    <div id="editLinkModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">编辑网址</h2>
                <span class="close" onclick="closeModal('editLinkModal')">&times;</span>
            </div>
            <form id="editLinkForm">
                <input type="hidden" id="editLinkId">
                <div class="form-group">
                    <label class="form-label">网站名称 *</label>
                    <input type="text" class="form-input" id="editLinkName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">网站地址 *</label>
                    <input type="url" class="form-input" id="editLinkUrl" required>
                </div>
                <div class="form-group">
                    <label class="form-label">网站描述</label>
                    <textarea class="form-textarea" id="editLinkDesc" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">分类 *</label>
                        <select class="form-select" id="editLinkCategory" required>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">图标</label>
                        <input type="text" class="form-input" id="editLinkIcon">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">标签</label>
                        <input type="text" class="form-input" id="editLinkTags">
                    </div>
                    <div class="form-group">
                        <label class="form-label">优先级</label>
                        <select class="form-select" id="editLinkPriority">
                            <option value="1">低</option>
                            <option value="2">中</option>
                            <option value="3">高</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('editLinkModal')">取消</button>
                    <button type="submit" class="btn btn-submit">保存修改</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 文件输入（隐藏） -->
    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImportFile(event)">

    <script>
        // 数据结构
        let categories = [];
        let links = [];

        // 初始化数据
        function initializeData() {
            // 从localStorage加载数据
            const savedCategories = localStorage.getItem('navigationCategories');
            const savedLinks = localStorage.getItem('navigationLinks');
            
            if (savedCategories) {
                categories = JSON.parse(savedCategories);
            } else {
                // 默认分类
                categories = [
                    { id: '3d', name: '3D打印独立站', icon: '🖨️', color: 'icon-3d', desc: '3D打印相关资源' },
                    { id: 'hardware', name: '硬件', icon: '🔧', color: 'icon-hardware', desc: '硬件开发资源' },
                    { id: 'software', name: '软件', icon: '💻', color: 'icon-software', desc: '软件开发工具' },
                    { id: 'model', name: '模型', icon: '🎯', color: 'icon-model', desc: '3D模型资源' },
                    { id: 'ai', name: 'AI', icon: '🤖', color: 'icon-ai', desc: '人工智能工具' },
                    { id: 'image', name: '图片', icon: '🖼️', color: 'icon-image', desc: '图片素材资源' },
                    { id: 'design', name: '产品设计', icon: '🎨', color: 'icon-design', desc: '设计相关资源' },
                    { id: 'pm', name: '产品经理', icon: '👨‍💼', color: 'icon-pm', desc: '产品管理资源' },
                    { id: 'prototype', name: '产品原型', icon: '📱', color: 'icon-prototype', desc: '原型设计工具' },
                    { id: 'app', name: 'APP推广', icon: '📱', color: 'icon-app', desc: '应用推广资源' }
                ];
            }
            
            if (savedLinks) {
                links = JSON.parse(savedLinks);
            } else {
                // 默认链接
                links = [
                    { id: '1', name: 'Thingiverse', url: 'https://www.thingiverse.com', desc: '全球最大的3D打印模型分享平台', category: '3d', icon: '📁', tags: '3D打印,模型,免费', priority: 2 },
                    { id: '2', name: 'Arduino', url: 'https://www.arduino.cc', desc: '开源电子原型平台', category: 'hardware', icon: '⚡', tags: '硬件,开源,教程', priority: 2 },
                    { id: '3', name: 'Blender', url: 'https://www.blender.org', desc: '免费3D建模和动画软件', category: 'software', icon: '🎬', tags: '3D建模,免费,开源', priority: 2 },
                    { id: '4', name: 'ChatGPT', url: 'https://chat.openai.com', desc: 'OpenAI对话AI助手', category: 'ai', icon: '💬', tags: 'AI,对话,助手', priority: 3 },
                    { id: '5', name: 'Unsplash', url: 'https://unsplash.com', desc: '高质量免费图片', category: 'image', icon: '📸', tags: '图片,免费,高质量', priority: 2 }
                ];
            }
            
            saveData();
            renderCategories();
            updateCategorySelects();
        }

        // 保存数据到localStorage
        function saveData() {
            localStorage.setItem('navigationCategories', JSON.stringify(categories));
            localStorage.setItem('navigationLinks', JSON.stringify(links));
        }

        // 渲染分类
        function renderCategories() {
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = '';
            
            categories.forEach(category => {
                const categoryLinks = links.filter(link => link.category === category.id);
                const categoryElement = createCategoryElement(category, categoryLinks);
                container.appendChild(categoryElement);
            });
        }

        // 创建分类元素
        function createCategoryElement(category, categoryLinks) {
            const categoryDiv = document.createElement('div');
            categoryDiv.className = 'category';
            categoryDiv.setAttribute('data-category', category.id);
            
            categoryDiv.innerHTML = `
                <div class="category-header">
                    <div class="category-title-section">
                        <div class="category-icon ${category.color}">${category.icon}</div>
                        <div class="category-title">${category.name}</div>
                    </div>
                    <div class="category-actions">
                        <button class="btn btn-small btn-secondary" onclick="addLinkToCategory('${category.id}')">
                            ➕ 添加网址
                        </button>
                        <button class="btn btn-small btn-secondary" onclick="editCategory('${category.id}')">
                            ✏️ 编辑
                        </button>
                        <button class="btn btn-small btn-secondary" onclick="deleteCategory('${category.id}')">
                            🗑️ 删除
                        </button>
                    </div>
                </div>
                <div class="links">
                    ${categoryLinks.length > 0 ? 
                        categoryLinks.map(link => createLinkElement(link)).join('') :
                        `<div class="empty-category">
                            <p>暂无网址</p>
                            <button class="btn btn-small btn-primary" onclick="addLinkToCategory('${category.id}')">
                                添加第一个网址
                            </button>
                        </div>`
                    }
                </div>
            `;
            
            return categoryDiv;
        }

        // 创建链接元素
        function createLinkElement(link) {
            return `
                <a href="${link.url}" target="_blank" class="link-item" data-link-id="${link.id}">
                    <div class="link-icon">${link.icon || '🌐'}</div>
                    <div>
                        <div class="link-text">${link.name}</div>
                        <div class="link-desc">${link.desc || ''}</div>
                        ${link.tags ? `<div class="link-desc">标签: ${link.tags}</div>` : ''}
                    </div>
                    <div class="link-actions">
                        <button class="btn btn-mini" onclick="editLink('${link.id}'); event.preventDefault();">
                            ✏️
                        </button>
                        <button class="btn btn-mini" onclick="deleteLink('${link.id}'); event.preventDefault();">
                            🗑️
                        </button>
                    </div>
                </a>
            `;
        }

        // 更新分类选择器
        function updateCategorySelects() {
            const selects = ['linkCategory', 'editLinkCategory'];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '<option value="">请选择分类</option>';
                    categories.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category.id;
                        option.textContent = category.name;
                        select.appendChild(option);
                    });
                }
            });
        }

        // 打开添加网址模态框
        function openAddLinkModal() {
            document.getElementById('addLinkModal').style.display = 'block';
            document.getElementById('addLinkForm').reset();
        }

        // 打开添加分类模态框
        function openAddCategoryModal() {
            document.getElementById('addCategoryModal').style.display = 'block';
            document.getElementById('addCategoryForm').reset();
        }

        // 关闭模态框
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // 添加网址到指定分类
        function addLinkToCategory(categoryId) {
            openAddLinkModal();
            document.getElementById('linkCategory').value = categoryId;
        }

        // 编辑分类
        function editCategory(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (category) {
                // 这里可以实现编辑分类的功能
                alert('编辑分类功能开发中...');
            }
        }

        // 删除分类
        function deleteCategory(categoryId) {
            if (confirm('确定要删除这个分类吗？分类下的所有网址也会被删除。')) {
                categories = categories.filter(c => c.id !== categoryId);
                links = links.filter(l => l.category !== categoryId);
                saveData();
                renderCategories();
                updateCategorySelects();
            }
        }

        // 编辑网址
        function editLink(linkId) {
            const link = links.find(l => l.id === linkId);
            if (link) {
                document.getElementById('editLinkId').value = link.id;
                document.getElementById('editLinkName').value = link.name;
                document.getElementById('editLinkUrl').value = link.url;
                document.getElementById('editLinkDesc').value = link.desc || '';
                document.getElementById('editLinkCategory').value = link.category;
                document.getElementById('editLinkIcon').value = link.icon || '';
                document.getElementById('editLinkTags').value = link.tags || '';
                document.getElementById('editLinkPriority').value = link.priority || 2;
                
                document.getElementById('editLinkModal').style.display = 'block';
            }
        }

        // 删除网址
        function deleteLink(linkId) {
            if (confirm('确定要删除这个网址吗？')) {
                links = links.filter(l => l.id !== linkId);
                saveData();
                renderCategories();
            }
        }

        // 导出数据
        function exportData() {
            const data = {
                categories: categories,
                links: links,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `网址导航_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // 导入数据
        function importData() {
            document.getElementById('importFile').click();
        }

        // 处理导入文件
        function handleImportFile(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (data.categories && data.links) {
                            if (confirm('确定要导入数据吗？这将覆盖现有数据。')) {
                                categories = data.categories;
                                links = data.links;
                                saveData();
                                renderCategories();
                                updateCategorySelects();
                                alert('数据导入成功！');
                            }
                        } else {
                            alert('文件格式不正确！');
                        }
                    } catch (error) {
                        alert('文件解析失败！');
                    }
                };
                reader.readAsText(file);
            }
            event.target.value = ''; // 清空文件输入
        }

        // 事件监听器
        document.addEventListener('DOMContentLoaded', function() {
            initializeData();
            
            // 添加网址表单提交
            document.getElementById('addLinkForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const newLink = {
                    id: Date.now().toString(),
                    name: document.getElementById('linkName').value,
                    url: document.getElementById('linkUrl').value,
                    desc: document.getElementById('linkDesc').value,
                    category: document.getElementById('linkCategory').value,
                    icon: document.getElementById('linkIcon').value || '🌐',
                    tags: document.getElementById('linkTags').value,
                    priority: parseInt(document.getElementById('linkPriority').value)
                };
                
                links.push(newLink);
                saveData();
                renderCategories();
                closeModal('addLinkModal');
                
                // 显示成功消息
                alert('网址添加成功！');
            });
            
            // 添加分类表单提交
            document.getElementById('addCategoryForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const newCategory = {
                    id: Date.now().toString(),
                    name: document.getElementById('categoryName').value,
                    icon: document.getElementById('categoryIcon').value || '📁',
                    color: document.getElementById('categoryColor').value,
                    desc: document.getElementById('categoryDesc').value
                };
                
                categories.push(newCategory);
                saveData();
                renderCategories();
                updateCategorySelects();
                closeModal('addCategoryModal');
                
                alert('分类添加成功！');
            });
            
            // 编辑网址表单提交
            document.getElementById('editLinkForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const linkId = document.getElementById('editLinkId').value;
                const linkIndex = links.findIndex(l => l.id === linkId);
                
                if (linkIndex !== -1) {
                    links[linkIndex] = {
                        id: linkId,
                        name: document.getElementById('editLinkName').value,
                        url: document.getElementById('editLinkUrl').value,
                        desc: document.getElementById('editLinkDesc').value,
                        category: document.getElementById('editLinkCategory').value,
                        icon: document.getElementById('editLinkIcon').value || '🌐',
                        tags: document.getElementById('editLinkTags').value,
                        priority: parseInt(document.getElementById('editLinkPriority').value)
                    };
                    
                    saveData();
                    renderCategories();
                    closeModal('editLinkModal');
                    
                    alert('网址修改成功！');
                }
            });
            
            // 搜索功能
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase().trim();
                
                if (searchTerm === '') {
                    renderCategories();
                    return;
                }
                
                // 过滤链接
                const filteredLinks = links.filter(link => 
                    link.name.toLowerCase().includes(searchTerm) ||
                    link.desc.toLowerCase().includes(searchTerm) ||
                    link.tags.toLowerCase().includes(searchTerm) ||
                    link.url.toLowerCase().includes(searchTerm)
                );
                
                // 过滤分类
                const filteredCategories = categories.filter(category => {
                    const categoryLinks = filteredLinks.filter(link => link.category === category.id);
                    return categoryLinks.length > 0 || category.name.toLowerCase().includes(searchTerm);
                });
                
                // 渲染过滤后的结果
                const container = document.getElementById('categoriesContainer');
                container.innerHTML = '';
                
                filteredCategories.forEach(category => {
                    const categoryLinks = filteredLinks.filter(link => link.category === category.id);
                    const categoryElement = createCategoryElement(category, categoryLinks);
                    container.appendChild(categoryElement);
                });
            });
        });

        // 点击模态框外部关闭
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        };
    </script>
</body>
</html>
