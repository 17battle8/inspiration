<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç½‘å€å¯¼èˆª - æˆ‘çš„æ”¶è—å¤¹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .search-box {
            background: white;
            border-radius: 50px;
            padding: 15px 25px;
            margin: 0 auto 30px;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
        }

        .search-box input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 16px;
            padding: 5px;
        }

        .search-box i {
            color: #667eea;
            margin-left: 10px;
            font-size: 18px;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn {
            background: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: white;
            color: #667eea;
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .category {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .category:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .category-title-section {
            display: flex;
            align-items: center;
        }

        .category-icon {
            width: 50px;
            height: 50px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 24px;
            color: white;
        }

        .category-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #333;
        }

        .category-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
        }

        .links {
            display: grid;
            gap: 12px;
        }

        .link-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 12px;
            text-decoration: none;
            color: #333;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .link-item:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
            border-color: #667eea;
        }

        .link-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            opacity: 0.7;
        }

        .link-text {
            flex: 1;
            font-size: 14px;
        }

        .link-desc {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 2px;
        }

        .link-actions {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .link-item:hover .link-actions {
            opacity: 1;
        }

        .btn-mini {
            padding: 4px 8px;
            font-size: 10px;
            border-radius: 10px;
            background: rgba(255,255,255,0.9);
            color: #333;
        }

        .footer {
            text-align: center;
            margin-top: 50px;
            color: white;
            opacity: 0.8;
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
        }

        .close {
            font-size: 28px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            background: white;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }

        .btn-cancel {
            background: #f8f9fa;
            color: #6c757d;
        }

        .btn-submit {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .empty-category {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }

        .empty-category p {
            margin-bottom: 15px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .categories {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .category {
                padding: 20px;
            }

            .action-buttons {
                flex-direction: column;
                align-items: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 10% auto;
                width: 95%;
                padding: 20px;
            }
        }

        /* å›¾æ ‡é¢œè‰² */
        .icon-3d { background: linear-gradient(135deg, #ff6b6b, #ee5a24); }
        .icon-hardware { background: linear-gradient(135deg, #4ecdc4, #44a08d); }
        .icon-software { background: linear-gradient(135deg, #45b7d1, #96c93d); }
        .icon-model { background: linear-gradient(135deg, #f9ca24, #f0932b); }
        .icon-ai { background: linear-gradient(135deg, #6c5ce7, #a29bfe); }
        .icon-image { background: linear-gradient(135deg, #fd79a8, #e84393); }
        .icon-design { background: linear-gradient(135deg, #00b894, #00cec9); }
        .icon-pm { background: linear-gradient(135deg, #e17055, #d63031); }
        .icon-prototype { background: linear-gradient(135deg, #74b9ff, #0984e3); }
        .icon-app { background: linear-gradient(135deg, #a8e6cf, #dcedc1); }
        .icon-custom { background: linear-gradient(135deg, #a29bfe, #6c5ce7); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”— ç½‘å€å¯¼èˆª</h1>
            <p>æˆ‘çš„æ”¶è—å¤¹ - ç²¾é€‰ä¼˜è´¨ç½‘ç«™èµ„æº</p>
        </div>

        <div class="search-box">
            <input type="text" id="searchInput" placeholder="æœç´¢ç½‘ç«™..." />
            <i>ğŸ”</i>
        </div>

        <div class="action-buttons">
            <button class="btn btn-primary" onclick="openAddLinkModal()">
                <span>â•</span>
                æ·»åŠ ç½‘å€
            </button>
            <button class="btn btn-secondary" onclick="openAddCategoryModal()">
                <span>ğŸ“</span>
                æ·»åŠ åˆ†ç±»
            </button>
            <button class="btn btn-secondary" onclick="exportData()">
                <span>ğŸ“¤</span>
                å¯¼å‡ºæ•°æ®
            </button>
            <button class="btn btn-secondary" onclick="importData()">
                <span>ğŸ“¥</span>
                å¯¼å…¥æ•°æ®
            </button>
        </div>

        <div class="categories" id="categoriesContainer">
            <!-- åˆ†ç±»å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>

        <div class="footer">
            <p>Â© 2024 ç½‘å€å¯¼èˆª - è®©ä¸Šç½‘æ›´é«˜æ•ˆ</p>
        </div>
    </div>

    <!-- æ·»åŠ ç½‘å€æ¨¡æ€æ¡† -->
    <div id="addLinkModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">æ·»åŠ æ–°ç½‘å€</h2>
                <span class="close" onclick="closeModal('addLinkModal')">&times;</span>
            </div>
            <form id="addLinkForm">
                <div class="form-group">
                    <label class="form-label">ç½‘ç«™åç§° *</label>
                    <input type="text" class="form-input" id="linkName" required placeholder="ä¾‹å¦‚ï¼šGoogle">
                </div>
                <div class="form-group">
                    <label class="form-label">ç½‘ç«™åœ°å€ *</label>
                    <input type="url" class="form-input" id="linkUrl" required placeholder="https://www.google.com">
                </div>
                <div class="form-group">
                    <label class="form-label">ç½‘ç«™æè¿°</label>
                    <textarea class="form-textarea" id="linkDesc" rows="3" placeholder="ç½‘ç«™çš„ä¸»è¦åŠŸèƒ½æˆ–ç‰¹ç‚¹"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">åˆ†ç±» *</label>
                        <select class="form-select" id="linkCategory" required>
                            <option value="">è¯·é€‰æ‹©åˆ†ç±»</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">å›¾æ ‡</label>
                        <input type="text" class="form-input" id="linkIcon" placeholder="ä¾‹å¦‚ï¼šğŸŒ">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">æ ‡ç­¾</label>
                        <input type="text" class="form-input" id="linkTags" placeholder="ç”¨é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ï¼šæœç´¢,å·¥å…·,å…è´¹">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ä¼˜å…ˆçº§</label>
                        <select class="form-select" id="linkPriority">
                            <option value="1">ä½</option>
                            <option value="2" selected>ä¸­</option>
                            <option value="3">é«˜</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('addLinkModal')">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-submit">æ·»åŠ ç½‘å€</button>
                </div>
            </form>
        </div>
    </div>

    <!-- æ·»åŠ åˆ†ç±»æ¨¡æ€æ¡† -->
    <div id="addCategoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">æ·»åŠ æ–°åˆ†ç±»</h2>
                <span class="close" onclick="closeModal('addCategoryModal')">&times;</span>
            </div>
            <form id="addCategoryForm">
                <div class="form-group">
                    <label class="form-label">åˆ†ç±»åç§° *</label>
                    <input type="text" class="form-input" id="categoryName" required placeholder="ä¾‹å¦‚ï¼šå­¦ä¹ èµ„æº">
                </div>
                <div class="form-group">
                    <label class="form-label">åˆ†ç±»å›¾æ ‡</label>
                    <input type="text" class="form-input" id="categoryIcon" placeholder="ä¾‹å¦‚ï¼šğŸ“š">
                </div>
                <div class="form-group">
                    <label class="form-label">åˆ†ç±»æè¿°</label>
                    <textarea class="form-textarea" id="categoryDesc" rows="3" placeholder="åˆ†ç±»çš„ç”¨é€”è¯´æ˜"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">åˆ†ç±»é¢œè‰²</label>
                    <select class="form-select" id="categoryColor">
                        <option value="icon-custom">è‡ªå®šä¹‰</option>
                        <option value="icon-3d">çº¢è‰²ç³»</option>
                        <option value="icon-hardware">ç»¿è‰²ç³»</option>
                        <option value="icon-software">è“è‰²ç³»</option>
                        <option value="icon-model">é»„è‰²ç³»</option>
                        <option value="icon-ai">ç´«è‰²ç³»</option>
                        <option value="icon-image">ç²‰è‰²ç³»</option>
                        <option value="icon-design">é’è‰²ç³»</option>
                        <option value="icon-pm">æ©™è‰²ç³»</option>
                        <option value="icon-prototype">è“è‰²ç³»</option>
                        <option value="icon-app">ç»¿è‰²ç³»</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('addCategoryModal')">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-submit">æ·»åŠ åˆ†ç±»</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ç¼–è¾‘ç½‘å€æ¨¡æ€æ¡† -->
    <div id="editLinkModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ç¼–è¾‘ç½‘å€</h2>
                <span class="close" onclick="closeModal('editLinkModal')">&times;</span>
            </div>
            <form id="editLinkForm">
                <input type="hidden" id="editLinkId">
                <div class="form-group">
                    <label class="form-label">ç½‘ç«™åç§° *</label>
                    <input type="text" class="form-input" id="editLinkName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ç½‘ç«™åœ°å€ *</label>
                    <input type="url" class="form-input" id="editLinkUrl" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ç½‘ç«™æè¿°</label>
                    <textarea class="form-textarea" id="editLinkDesc" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">åˆ†ç±» *</label>
                        <select class="form-select" id="editLinkCategory" required>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">å›¾æ ‡</label>
                        <input type="text" class="form-input" id="editLinkIcon">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">æ ‡ç­¾</label>
                        <input type="text" class="form-input" id="editLinkTags">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ä¼˜å…ˆçº§</label>
                        <select class="form-select" id="editLinkPriority">
                            <option value="1">ä½</option>
                            <option value="2">ä¸­</option>
                            <option value="3">é«˜</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('editLinkModal')">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-submit">ä¿å­˜ä¿®æ”¹</button>
                </div>
            </form>
        </div>
    </div>

    <!-- æ–‡ä»¶è¾“å…¥ï¼ˆéšè—ï¼‰ -->
    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImportFile(event)">

    <script>
        // æ•°æ®ç»“æ„
        let categories = [];
        let links = [];

        // åˆå§‹åŒ–æ•°æ®
        function initializeData() {
            // ä»localStorageåŠ è½½æ•°æ®
            const savedCategories = localStorage.getItem('navigationCategories');
            const savedLinks = localStorage.getItem('navigationLinks');
            
            if (savedCategories) {
                categories = JSON.parse(savedCategories);
            } else {
                // é»˜è®¤åˆ†ç±»
                categories = [
                    { id: '3d', name: '3Dæ‰“å°ç‹¬ç«‹ç«™', icon: 'ğŸ–¨ï¸', color: 'icon-3d', desc: '3Dæ‰“å°ç›¸å…³èµ„æº' },
                    { id: 'hardware', name: 'ç¡¬ä»¶', icon: 'ğŸ”§', color: 'icon-hardware', desc: 'ç¡¬ä»¶å¼€å‘èµ„æº' },
                    { id: 'software', name: 'è½¯ä»¶', icon: 'ğŸ’»', color: 'icon-software', desc: 'è½¯ä»¶å¼€å‘å·¥å…·' },
                    { id: 'model', name: 'æ¨¡å‹', icon: 'ğŸ¯', color: 'icon-model', desc: '3Dæ¨¡å‹èµ„æº' },
                    { id: 'ai', name: 'AI', icon: 'ğŸ¤–', color: 'icon-ai', desc: 'äººå·¥æ™ºèƒ½å·¥å…·' },
                    { id: 'image', name: 'å›¾ç‰‡', icon: 'ğŸ–¼ï¸', color: 'icon-image', desc: 'å›¾ç‰‡ç´ æèµ„æº' },
                    { id: 'design', name: 'äº§å“è®¾è®¡', icon: 'ğŸ¨', color: 'icon-design', desc: 'è®¾è®¡ç›¸å…³èµ„æº' },
                    { id: 'pm', name: 'äº§å“ç»ç†', icon: 'ğŸ‘¨â€ğŸ’¼', color: 'icon-pm', desc: 'äº§å“ç®¡ç†èµ„æº' },
                    { id: 'prototype', name: 'äº§å“åŸå‹', icon: 'ğŸ“±', color: 'icon-prototype', desc: 'åŸå‹è®¾è®¡å·¥å…·' },
                    { id: 'app', name: 'APPæ¨å¹¿', icon: 'ğŸ“±', color: 'icon-app', desc: 'åº”ç”¨æ¨å¹¿èµ„æº' }
                ];
            }
            
            if (savedLinks) {
                links = JSON.parse(savedLinks);
            } else {
                // é»˜è®¤é“¾æ¥
                links = [
                    { id: '1', name: 'Thingiverse', url: 'https://www.thingiverse.com', desc: 'å…¨çƒæœ€å¤§çš„3Dæ‰“å°æ¨¡å‹åˆ†äº«å¹³å°', category: '3d', icon: 'ğŸ“', tags: '3Dæ‰“å°,æ¨¡å‹,å…è´¹', priority: 2 },
                    { id: '2', name: 'Arduino', url: 'https://www.arduino.cc', desc: 'å¼€æºç”µå­åŸå‹å¹³å°', category: 'hardware', icon: 'âš¡', tags: 'ç¡¬ä»¶,å¼€æº,æ•™ç¨‹', priority: 2 },
                    { id: '3', name: 'Blender', url: 'https://www.blender.org', desc: 'å…è´¹3Då»ºæ¨¡å’ŒåŠ¨ç”»è½¯ä»¶', category: 'software', icon: 'ğŸ¬', tags: '3Då»ºæ¨¡,å…è´¹,å¼€æº', priority: 2 },
                    { id: '4', name: 'ChatGPT', url: 'https://chat.openai.com', desc: 'OpenAIå¯¹è¯AIåŠ©æ‰‹', category: 'ai', icon: 'ğŸ’¬', tags: 'AI,å¯¹è¯,åŠ©æ‰‹', priority: 3 },
                    { id: '5', name: 'Unsplash', url: 'https://unsplash.com', desc: 'é«˜è´¨é‡å…è´¹å›¾ç‰‡', category: 'image', icon: 'ğŸ“¸', tags: 'å›¾ç‰‡,å…è´¹,é«˜è´¨é‡', priority: 2 }
                ];
            }
            
            saveData();
            renderCategories();
            updateCategorySelects();
        }

        // ä¿å­˜æ•°æ®åˆ°localStorage
        function saveData() {
            localStorage.setItem('navigationCategories', JSON.stringify(categories));
            localStorage.setItem('navigationLinks', JSON.stringify(links));
        }

        // æ¸²æŸ“åˆ†ç±»
        function renderCategories() {
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = '';
            
            categories.forEach(category => {
                const categoryLinks = links.filter(link => link.category === category.id);
                const categoryElement = createCategoryElement(category, categoryLinks);
                container.appendChild(categoryElement);
            });
        }

        // åˆ›å»ºåˆ†ç±»å…ƒç´ 
        function createCategoryElement(category, categoryLinks) {
            const categoryDiv = document.createElement('div');
            categoryDiv.className = 'category';
            categoryDiv.setAttribute('data-category', category.id);
            
            categoryDiv.innerHTML = `
                <div class="category-header">
                    <div class="category-title-section">
                        <div class="category-icon ${category.color}">${category.icon}</div>
                        <div class="category-title">${category.name}</div>
                    </div>
                    <div class="category-actions">
                        <button class="btn btn-small btn-secondary" onclick="addLinkToCategory('${category.id}')">
                            â• æ·»åŠ ç½‘å€
                        </button>
                        <button class="btn btn-small btn-secondary" onclick="editCategory('${category.id}')">
                            âœï¸ ç¼–è¾‘
                        </button>
                        <button class="btn btn-small btn-secondary" onclick="deleteCategory('${category.id}')">
                            ğŸ—‘ï¸ åˆ é™¤
                        </button>
                    </div>
                </div>
                <div class="links">
                    ${categoryLinks.length > 0 ? 
                        categoryLinks.map(link => createLinkElement(link)).join('') :
                        `<div class="empty-category">
                            <p>æš‚æ— ç½‘å€</p>
                            <button class="btn btn-small btn-primary" onclick="addLinkToCategory('${category.id}')">
                                æ·»åŠ ç¬¬ä¸€ä¸ªç½‘å€
                            </button>
                        </div>`
                    }
                </div>
            `;
            
            return categoryDiv;
        }

        // åˆ›å»ºé“¾æ¥å…ƒç´ 
        function createLinkElement(link) {
            return `
                <a href="${link.url}" target="_blank" class="link-item" data-link-id="${link.id}">
                    <div class="link-icon">${link.icon || 'ğŸŒ'}</div>
                    <div>
                        <div class="link-text">${link.name}</div>
                        <div class="link-desc">${link.desc || ''}</div>
                        ${link.tags ? `<div class="link-desc">æ ‡ç­¾: ${link.tags}</div>` : ''}
                    </div>
                    <div class="link-actions">
                        <button class="btn btn-mini" onclick="editLink('${link.id}'); event.preventDefault();">
                            âœï¸
                        </button>
                        <button class="btn btn-mini" onclick="deleteLink('${link.id}'); event.preventDefault();">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                </a>
            `;
        }

        // æ›´æ–°åˆ†ç±»é€‰æ‹©å™¨
        function updateCategorySelects() {
            const selects = ['linkCategory', 'editLinkCategory'];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '<option value="">è¯·é€‰æ‹©åˆ†ç±»</option>';
                    categories.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category.id;
                        option.textContent = category.name;
                        select.appendChild(option);
                    });
                }
            });
        }

        // æ‰“å¼€æ·»åŠ ç½‘å€æ¨¡æ€æ¡†
        function openAddLinkModal() {
            document.getElementById('addLinkModal').style.display = 'block';
            document.getElementById('addLinkForm').reset();
        }

        // æ‰“å¼€æ·»åŠ åˆ†ç±»æ¨¡æ€æ¡†
        function openAddCategoryModal() {
            document.getElementById('addCategoryModal').style.display = 'block';
            document.getElementById('addCategoryForm').reset();
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // æ·»åŠ ç½‘å€åˆ°æŒ‡å®šåˆ†ç±»
        function addLinkToCategory(categoryId) {
            openAddLinkModal();
            document.getElementById('linkCategory').value = categoryId;
        }

        // ç¼–è¾‘åˆ†ç±»
        function editCategory(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (category) {
                // è¿™é‡Œå¯ä»¥å®ç°ç¼–è¾‘åˆ†ç±»çš„åŠŸèƒ½
                alert('ç¼–è¾‘åˆ†ç±»åŠŸèƒ½å¼€å‘ä¸­...');
            }
        }

        // åˆ é™¤åˆ†ç±»
        function deleteCategory(categoryId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªåˆ†ç±»å—ï¼Ÿåˆ†ç±»ä¸‹çš„æ‰€æœ‰ç½‘å€ä¹Ÿä¼šè¢«åˆ é™¤ã€‚')) {
                categories = categories.filter(c => c.id !== categoryId);
                links = links.filter(l => l.category !== categoryId);
                saveData();
                renderCategories();
                updateCategorySelects();
            }
        }

        // ç¼–è¾‘ç½‘å€
        function editLink(linkId) {
            const link = links.find(l => l.id === linkId);
            if (link) {
                document.getElementById('editLinkId').value = link.id;
                document.getElementById('editLinkName').value = link.name;
                document.getElementById('editLinkUrl').value = link.url;
                document.getElementById('editLinkDesc').value = link.desc || '';
                document.getElementById('editLinkCategory').value = link.category;
                document.getElementById('editLinkIcon').value = link.icon || '';
                document.getElementById('editLinkTags').value = link.tags || '';
                document.getElementById('editLinkPriority').value = link.priority || 2;
                
                document.getElementById('editLinkModal').style.display = 'block';
            }
        }

        // åˆ é™¤ç½‘å€
        function deleteLink(linkId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç½‘å€å—ï¼Ÿ')) {
                links = links.filter(l => l.id !== linkId);
                saveData();
                renderCategories();
            }
        }

        // å¯¼å‡ºæ•°æ®
        function exportData() {
            const data = {
                categories: categories,
                links: links,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ç½‘å€å¯¼èˆª_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // å¯¼å…¥æ•°æ®
        function importData() {
            document.getElementById('importFile').click();
        }

        // å¤„ç†å¯¼å…¥æ–‡ä»¶
        function handleImportFile(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (data.categories && data.links) {
                            if (confirm('ç¡®å®šè¦å¯¼å…¥æ•°æ®å—ï¼Ÿè¿™å°†è¦†ç›–ç°æœ‰æ•°æ®ã€‚')) {
                                categories = data.categories;
                                links = data.links;
                                saveData();
                                renderCategories();
                                updateCategorySelects();
                                alert('æ•°æ®å¯¼å…¥æˆåŠŸï¼');
                            }
                        } else {
                            alert('æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼');
                        }
                    } catch (error) {
                        alert('æ–‡ä»¶è§£æå¤±è´¥ï¼');
                    }
                };
                reader.readAsText(file);
            }
            event.target.value = ''; // æ¸…ç©ºæ–‡ä»¶è¾“å…¥
        }

        // äº‹ä»¶ç›‘å¬å™¨
        document.addEventListener('DOMContentLoaded', function() {
            initializeData();
            
            // æ·»åŠ ç½‘å€è¡¨å•æäº¤
            document.getElementById('addLinkForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const newLink = {
                    id: Date.now().toString(),
                    name: document.getElementById('linkName').value,
                    url: document.getElementById('linkUrl').value,
                    desc: document.getElementById('linkDesc').value,
                    category: document.getElementById('linkCategory').value,
                    icon: document.getElementById('linkIcon').value || 'ğŸŒ',
                    tags: document.getElementById('linkTags').value,
                    priority: parseInt(document.getElementById('linkPriority').value)
                };
                
                links.push(newLink);
                saveData();
                renderCategories();
                closeModal('addLinkModal');
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                alert('ç½‘å€æ·»åŠ æˆåŠŸï¼');
            });
            
            // æ·»åŠ åˆ†ç±»è¡¨å•æäº¤
            document.getElementById('addCategoryForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const newCategory = {
                    id: Date.now().toString(),
                    name: document.getElementById('categoryName').value,
                    icon: document.getElementById('categoryIcon').value || 'ğŸ“',
                    color: document.getElementById('categoryColor').value,
                    desc: document.getElementById('categoryDesc').value
                };
                
                categories.push(newCategory);
                saveData();
                renderCategories();
                updateCategorySelects();
                closeModal('addCategoryModal');
                
                alert('åˆ†ç±»æ·»åŠ æˆåŠŸï¼');
            });
            
            // ç¼–è¾‘ç½‘å€è¡¨å•æäº¤
            document.getElementById('editLinkForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const linkId = document.getElementById('editLinkId').value;
                const linkIndex = links.findIndex(l => l.id === linkId);
                
                if (linkIndex !== -1) {
                    links[linkIndex] = {
                        id: linkId,
                        name: document.getElementById('editLinkName').value,
                        url: document.getElementById('editLinkUrl').value,
                        desc: document.getElementById('editLinkDesc').value,
                        category: document.getElementById('editLinkCategory').value,
                        icon: document.getElementById('editLinkIcon').value || 'ğŸŒ',
                        tags: document.getElementById('editLinkTags').value,
                        priority: parseInt(document.getElementById('editLinkPriority').value)
                    };
                    
                    saveData();
                    renderCategories();
                    closeModal('editLinkModal');
                    
                    alert('ç½‘å€ä¿®æ”¹æˆåŠŸï¼');
                }
            });
            
            // æœç´¢åŠŸèƒ½
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase().trim();
                
                if (searchTerm === '') {
                    renderCategories();
                    return;
                }
                
                // è¿‡æ»¤é“¾æ¥
                const filteredLinks = links.filter(link => 
                    link.name.toLowerCase().includes(searchTerm) ||
                    link.desc.toLowerCase().includes(searchTerm) ||
                    link.tags.toLowerCase().includes(searchTerm) ||
                    link.url.toLowerCase().includes(searchTerm)
                );
                
                // è¿‡æ»¤åˆ†ç±»
                const filteredCategories = categories.filter(category => {
                    const categoryLinks = filteredLinks.filter(link => link.category === category.id);
                    return categoryLinks.length > 0 || category.name.toLowerCase().includes(searchTerm);
                });
                
                // æ¸²æŸ“è¿‡æ»¤åçš„ç»“æœ
                const container = document.getElementById('categoriesContainer');
                container.innerHTML = '';
                
                filteredCategories.forEach(category => {
                    const categoryLinks = filteredLinks.filter(link => link.category === category.id);
                    const categoryElement = createCategoryElement(category, categoryLinks);
                    container.appendChild(categoryElement);
                });
            });
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        };
    </script>
</body>
</html>
